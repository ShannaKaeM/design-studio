"use strict";(globalThis.webpackChunksuremembers=globalThis.webpackChunksuremembers||[]).push([[7145],{7145:(l,e,i)=>{i.r(e),i.d(e,{sc_downloads_list:()=>a});var o=i(4589),s=i(9964),n=i(3659),d=i(2538);i(857);const a=class{constructor(l){(0,o.r)(this,l),this.renderFileExt=l=>{var e,i,s,n,d,a,t,r,u;if(null===(e=null==l?void 0:l.media)||void 0===e?void 0:e.filename)return null===(d=null===(n=null===(s=(i=l.media.filename).split)||void 0===s?void 0:s.call(i,"."))||void 0===n?void 0:n.pop)||void 0===d?void 0:d.call(n);if(null==l?void 0:l.url)try{const e=new URL(l.url);if(e.pathname.includes("."))return null===(u=null===(r=null===(t=(a=e.pathname).split)||void 0===t?void 0:t.call(a,"."))||void 0===r?void 0:r.pop)||void 0===u?void 0:u.call(r)}catch(l){console.error(l)}return(0,o.h)("sc-icon",{name:"file"})},this.downloads=void 0,this.customerId=void 0,this.heading=void 0,this.busy=void 0,this.error=void 0}async downloadItem(l){var e,i;if(null==l?void 0:l.url)return void this.downloadFile(l.url,null!==(e=null==l?void 0:l.name)&&void 0!==e?e:"file");const o=null===(i=null==l?void 0:l.media)||void 0===i?void 0:i.id;if(o)try{this.busy=o;const l=await(0,s.a)({path:(0,d.a)(`surecart/v1/customers/${this.customerId}/expose/${o}`,{expose_for:60})});if(!(null==l?void 0:l.url))throw{message:(0,n._)("Could not download the file.","surecart")};this.downloadFile(null==l?void 0:l.url,l.filename)}catch(l){console.error(l),this.error=(null==l?void 0:l.message)||(0,n._)("Something went wrong","surecart")}finally{this.busy=null}}downloadFile(l,e){const i=document.createElement("a");i.href=l,i.download=e,document.body.appendChild(i),i.click(),setTimeout((()=>{document.body.removeChild(i)}),0)}render(){const l=this.downloads||[];return(0,o.h)("sc-dashboard-module",{class:"purchase",part:"base",heading:(0,n._)("Downloads","surecart")},(0,o.h)("span",{slot:"heading"},(0,o.h)("slot",{name:"heading"},this.heading||(0,n._)("Downloads","surecart"))),(0,o.h)("sc-card",{"no-padding":!0},(0,o.h)("sc-stacked-list",null,l.map((l=>{var e,i,s,d;const a=null==l?void 0:l.media;return(0,o.h)("sc-stacked-list-row",{style:{"--columns":"1"}},(0,o.h)("sc-flex",{class:"single-download",justifyContent:"flex-start",alignItems:"center"},(0,o.h)("div",{class:"single-download__preview"},this.renderFileExt(l)),(0,o.h)("div",null,(0,o.h)("div",null,(0,o.h)("strong",null,null!==(i=null!==(e=null==a?void 0:a.filename)&&void 0!==e?e:null==l?void 0:l.name)&&void 0!==i?i:"")),(0,o.h)("sc-flex",{justifyContent:"flex-start",alignItems:"center",style:{gap:"0.5em"}},(null==a?void 0:a.byte_size)&&(0,o.h)("sc-format-bytes",{value:a.byte_size}),!!(null===(s=null==a?void 0:a.release_json)||void 0===s?void 0:s.version)&&(0,o.h)("sc-tag",{type:"primary",size:"small",style:{"--sc-tag-primary-background-color":"#f3e8ff","--sc-tag-primary-color":"#6b21a8"}},"v",null===(d=null==a?void 0:a.release_json)||void 0===d?void 0:d.version)))),(0,o.h)("sc-button",{size:"small",slot:"suffix",onClick:()=>this.downloadItem(l),busy:!!(null==a?void 0:a.id)&&this.busy==(null==a?void 0:a.id),disabled:!!(null==a?void 0:a.id)&&this.busy==(null==a?void 0:a.id)},(0,n._)("Download","surecart")))})))))}};a.style=":host{display:block}.purchase{display:flex;flex-direction:column;gap:var(--sc-spacing-large)}.single-download .single-download__preview{display:flex;align-items:center;justify-content:center;background:var(--sc-color-gray-200);border-radius:var(--sc-border-radius-small);height:4rem;min-width:4rem;width:4rem}"}}]);