"use strict";(globalThis.webpackChunksuremembers=globalThis.webpackChunksuremembers||[]).push([[5649],{3524:(i,e,t)=>{t.d(e,{a:()=>g,b:()=>l,c:()=>m,d:()=>p,e:()=>c,f:()=>_,g:()=>v,r:()=>f,u:()=>k});var o=t(1874),a=t(9964),n=t(3659),s=t(2538),d=t(5792);const l="surecart/v1/checkouts/",c=["line_items","line_item.price","line_item.fees","line_item.variant","variant.image","price.product","product.featured_product_media","product.product_collections","product_media.media","customer","customer.shipping_address","payment_intent","discount","discount.promotion","recommended_bumps","bump.price","current_upsell","product.variants","discount.coupon","shipping_address","tax_identifier","manual_payment_method","shipping_choices","shipping_choice.shipping_method"],u=(i={})=>{var e,t,a,n,s,d;return{live_mode:"test"!==o.s.mode,group_key:o.s.groupId,abandoned_checkout_enabled:o.s.abandonedCheckoutEnabled,metadata:{...(null==i?void 0:i.metadata)||{},...(null===(e=null===window||void 0===window?void 0:window.scData)||void 0===e?void 0:e.page_id)&&{page_id:null===(t=null===window||void 0===window?void 0:window.scData)||void 0===t?void 0:t.page_id},...(null===(a=null===o.s||void 0===o.s?void 0:o.s.product)||void 0===a?void 0:a.id)&&{buy_page_product_id:null===(n=null===o.s||void 0===o.s?void 0:o.s.product)||void 0===n?void 0:n.id},page_url:window.location.href},...(null===(s=null===o.s||void 0===o.s?void 0:o.s.checkout)||void 0===s?void 0:s.email)&&{email:null===(d=null===o.s||void 0===o.s?void 0:o.s.checkout)||void 0===d?void 0:d.email},...i}},r=(i={})=>{var e,t;return{...!!(null===o.s||void 0===o.s?void 0:o.s.formId)&&{form_id:null===o.s||void 0===o.s?void 0:o.s.formId},...!!(null===(e=null===o.s||void 0===o.s?void 0:o.s.product)||void 0===e?void 0:e.id)&&{product_id:null===(t=null===o.s||void 0===o.s?void 0:o.s.product)||void 0===t?void 0:t.id},...i}},h=(i,e="")=>{let t=i?`${l}${i}`:l;return t=`${t}${e}`,(0,s.a)(t,{expand:c})},v=async({id:i,query:e={}})=>await(0,a.a)({path:(0,s.a)(h(i),r(e))}),m=async({id:i=null,data:e={},query:t={}})=>{var n,l;return i=i||(0,d.g)(window.location.href,"checkout_id")||((null===(n=null===o.s||void 0===o.s?void 0:o.s.checkout)||void 0===n?void 0:n.id)?null===(l=null===o.s||void 0===o.s?void 0:o.s.checkout)||void 0===l?void 0:l.id:null),await(0,a.a)({method:i?"PATCH":"POST",path:(0,s.a)(h(i),r(t)),data:u(e)})},p=async({id:i,data:e={},query:t={}})=>await(0,a.a)({method:"PATCH",path:(0,s.a)(h(i),r(t)),data:u(e)}),_=async({id:i,data:e={},query:t={},processor:o})=>await(0,a.a)({method:"POST",path:(0,s.a)(h(i,"/finalize"),r({...(null==o?void 0:o.manual)?{manual_payment:!0,manual_payment_method_id:null==o?void 0:o.id}:{processor_type:null==o?void 0:o.id},...t})),data:u(e)}),g=async({checkout:i,data:e,live_mode:t=!1})=>{var o;const n=((null===(o=null==i?void 0:i.line_items)||void 0===o?void 0:o.data)||[]).find((i=>{var t;return(null===(t=null==i?void 0:i.variant)||void 0===t?void 0:t.id)?i.variant.id===e.variant&&i.price.id===e.price:i.price.id===e.price}));if(!(null==i?void 0:i.id))return await(0,a.a)({method:"POST",path:(0,s.a)(h(null)),data:{line_items:[e],live_mode:t}});if(n)return await k({id:null==n?void 0:n.id,data:{...e,quantity:(null==n?void 0:n.quantity)+(null==e?void 0:e.quantity)}});const d=await(0,a.a)({path:(0,s.a)(`surecart/v1/line_items/${(null==n?void 0:n.id)?null==n?void 0:n.id:""}`,{consolidate:!0,expand:[...(c||[]).map((i=>i.includes(".")?i:`checkout.${i}`)),"checkout"]}),method:"POST",data:{...e,checkout:i.id}});return null==d?void 0:d.checkout},f=async({checkoutId:i,itemId:e})=>{const{deleted:t}=await(0,a.a)({path:`surecart/v1/line_items/${e}`,method:"DELETE"});if(!t)throw{code:"error",message:(0,n._)("Failed to delete","surecart")};return await v({id:i})},k=async({id:i,data:e})=>{const t=await(0,a.a)({path:(0,s.a)(`surecart/v1/line_items/${i}`,{expand:[...(c||[]).map((i=>i.includes(".")?i:`checkout.${i}`)),"checkout"]}),method:"PATCH",data:e});return null==t?void 0:t.checkout}},5649:(i,e,t)=>{t.r(e),t.d(e,{sc_customer_email:()=>c});var o=t(4589),a=t(3659),n=t(3524),s=t(7421),d=t(3876),l=t(1874);t(857),t(9964),t(2574),t(8445),t(7808);const c=class{constructor(i){(0,o.r)(this,i),this.scChange=(0,o.c)(this,"scChange",7),this.scClear=(0,o.c)(this,"scClear",7),this.scInput=(0,o.c)(this,"scInput",7),this.scFocus=(0,o.c)(this,"scFocus",7),this.scBlur=(0,o.c)(this,"scBlur",7),this.scUpdateOrderState=(0,o.c)(this,"scUpdateOrderState",7),this.scUpdateAbandonedCart=(0,o.c)(this,"scUpdateAbandonedCart",7),this.scLoginPrompt=(0,o.c)(this,"scLoginPrompt",7),this.trackingConfirmationMessage=void 0,this.size="medium",this.value=(0,s.a)("email"),this.pill=!1,this.label=void 0,this.showLabel=!0,this.help="",this.placeholder=void 0,this.disabled=!1,this.readonly=!1,this.required=!1,this.invalid=!1,this.autofocus=void 0,this.hasFocus=void 0}async handleChange(){this.value=this.input.value,this.scChange.emit();try{l.s.checkout=await(0,n.c)({id:l.s.checkout.id,data:{email:this.input.value}})}catch(i){console.log(i)}}async reportValidity(){var i,e;return null===(e=null===(i=this.input)||void 0===i?void 0:i.reportValidity)||void 0===e?void 0:e.call(i)}handleSessionChange(){var i,e,t,o,a,n;if(this.value&&!d.s.loggedIn)return;if(d.s.loggedIn)return void(this.value=d.s.email||(null===(e=null===(i=null===l.s||void 0===l.s?void 0:l.s.checkout)||void 0===i?void 0:i.customer)||void 0===e?void 0:e.email)||(null===(t=null===l.s||void 0===l.s?void 0:l.s.checkout)||void 0===t?void 0:t.email));const c=(0,s.a)("email");d.s.loggedIn||!c?this.value=(null===(o=null===l.s||void 0===l.s?void 0:l.s.checkout)||void 0===o?void 0:o.email)||(null===(n=null===(a=null===l.s||void 0===l.s?void 0:l.s.checkout)||void 0===a?void 0:a.customer)||void 0===n?void 0:n.email):this.value=c}componentWillLoad(){this.handleSessionChange(),this.removeCheckoutListener=(0,l.o)("checkout",(()=>this.handleSessionChange()))}disconnectedCallback(){this.removeCheckoutListener()}renderOptIn(){return this.trackingConfirmationMessage?!1!==l.s.abandonedCheckoutEnabled?(0,o.h)("div",{class:"tracking-confirmation-message"},(0,o.h)("span",null,this.trackingConfirmationMessage)," ",(0,o.h)("a",{href:"#",onClick:i=>{i.preventDefault(),this.scUpdateAbandonedCart.emit(!1)}},(0,a._)("No Thanks","surecart"))):(0,o.h)("div",{class:"tracking-confirmation-message"},(0,o.h)("span",null," ",(0,a._)("You won't receive further emails from us.","surecart"))):null}render(){var i;return(0,o.h)(o.H,null,(0,o.h)("sc-input",{exportparts:"base, input, form-control, label, help-text, prefix, suffix",type:"email",name:"email",ref:i=>this.input=i,value:this.value,help:this.help,label:this.label,autocomplete:"email",placeholder:this.placeholder,disabled:!!d.s.loggedIn&&!!(null===(i=this.value)||void 0===i?void 0:i.length)&&!this.invalid,readonly:this.readonly,required:!0,invalid:this.invalid,autofocus:this.autofocus,hasFocus:this.hasFocus,onScChange:()=>this.handleChange(),onScInput:()=>this.scInput.emit(),onScFocus:()=>this.scFocus.emit(),onScBlur:()=>this.scBlur.emit()}),this.renderOptIn())}};c.style=":host{display:block}a{color:var(--sc-color-primary-500)}a.customer-email__login-link{color:var(--sc-customer-login-link-color, var(--sc-input-placeholder-color));text-decoration:none;font-size:var(--sc-font-size-small)}.tracking-confirmation-message{font-size:var(--sc-font-size-xx-small)}.tracking-confirmation-message span{opacity:0.75}"},3876:(i,e,t)=>{t.d(e,{s:()=>s});var o=t(2574),a=t(4904);const{user:n}=(0,a.g)(),{state:s,onChange:d,dispose:l}=(0,o.c)({loggedIn:!1,email:"",name:"",...n})},7421:(i,e,t)=>{t.d(e,{a:()=>a,b:()=>o,g:()=>s,i:()=>d,s:()=>n});const o=i=>{let e;try{e=new URL(i)}catch(i){return!1}return"http:"===e.protocol||"https:"===e.protocol},a=i=>{const e=window.location.search;return new URLSearchParams(e).get(i)},n=(i,e,t)=>(i||[]).sort(((i,o)=>-1===t.indexOf(null==i?void 0:i[e])?1:-1===t.indexOf(null==o?void 0:o[e])?-1:t.indexOf(null==i?void 0:i[e])-t.indexOf(null==o?void 0:o[e]))),s=({variants:i,values:e})=>{const t=Object.keys(e);for(const o of i){const i=["option_1","option_2","option_3"].map((i=>o[i])).filter((i=>null!=i));if((null==i?void 0:i.length)===(null==t?void 0:t.length)&&t.every((t=>i.includes(e[t]))))return o}return null},d=(i,e)=>{const t=parseInt(i);return!(e&&((null==e?void 0:e.ad_hoc_max_amount)||(null==e?void 0:e.ad_hoc_min_amount))&&((null==e?void 0:e.ad_hoc_max_amount)&&t>(null==e?void 0:e.ad_hoc_max_amount)||(null==e?void 0:e.ad_hoc_min_amount)&&t<(null==e?void 0:e.ad_hoc_min_amount)))}}}]);