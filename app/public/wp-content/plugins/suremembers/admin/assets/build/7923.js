"use strict";(globalThis.webpackChunksuremembers=globalThis.webpackChunksuremembers||[]).push([[7923],{9038:(e,t,r)=>{r.d(t,{p:()=>n});var n=(0,r(3659).c)((function(e,t){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0});var n,o="https://js.stripe.com/v3",i=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,s="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",a=null,l=function(e){return null!==a||(a=new Promise((function(t,r){if("undefined"!=typeof window)if(window.Stripe&&e&&console.warn(s),window.Stripe)t(window.Stripe);else try{var n=function(){for(var e=document.querySelectorAll('script[src^="'.concat(o,'"]')),t=0;t<e.length;t++){var r=e[t];if(i.test(r.src))return r}return null}();n&&e?console.warn(s):n||(n=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(o).concat(t);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(r),r}(e)),n.addEventListener("load",(function(){window.Stripe?t(window.Stripe):r(new Error("Stripe.js not available"))})),n.addEventListener("error",(function(){r(new Error("Failed to load Stripe.js"))}))}catch(e){return void r(e)}else t(null)}))),a},d=function(e,t,r){if(null===e)return null;var n=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.32.0",startTime:t})}(n,r),n},c=!1,u=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];c=!0;var o=Date.now();return l(n).then((function(e){return d(e,t,o)}))};u.setLoadParameters=function(e){if(c)throw new Error("You cannot change load parameters after calling loadStripe");n=function(e){var t="invalid load parameters; expected object of shape\n\n    {advancedFraudSignals: boolean}\n\nbut received\n\n    ".concat(JSON.stringify(e),"\n");if(null===e||"object"!==r(e))throw new Error(t);if(1===Object.keys(e).length&&"boolean"==typeof e.advancedFraudSignals)return e;throw new Error(t)}(e)},t.loadStripe=u}))},7923:(e,t,r)=>{r.r(t),r.d(t,{sc_stripe_add_method:()=>l});var n=r(4589),o=r(9038),i=r(3659),s=r(9964),a=r(2538);r(857);const l=class{constructor(e){(0,n.r)(this,e),this.liveMode=!0,this.customerId=void 0,this.successUrl=void 0,this.loading=void 0,this.loaded=void 0,this.error=void 0,this.paymentIntent=void 0}componentWillLoad(){this.createPaymentIntent()}async handlePaymentIntentCreate(){var e,t,r,n,s,a,l,d,c,u,p,h,m,v,y,f,g,w;if(!(null===(r=null===(t=null===(e=this.paymentIntent)||void 0===e?void 0:e.processor_data)||void 0===t?void 0:t.stripe)||void 0===r?void 0:r.publishable_key)||!(null===(a=null===(s=null===(n=this.paymentIntent)||void 0===n?void 0:n.processor_data)||void 0===s?void 0:s.stripe)||void 0===a?void 0:a.account_id))return;if(!this.stripe)try{this.stripe=await o.p.loadStripe(null===(c=null===(d=null===(l=this.paymentIntent)||void 0===l?void 0:l.processor_data)||void 0===d?void 0:d.stripe)||void 0===c?void 0:c.publishable_key,{stripeAccount:null===(h=null===(p=null===(u=this.paymentIntent)||void 0===u?void 0:u.processor_data)||void 0===p?void 0:p.stripe)||void 0===h?void 0:h.account_id})}catch(e){return void(this.error=(null==e?void 0:e.message)||(0,i._)("Stripe could not be loaded","surecart"))}if(!(null===(y=null===(v=null===(m=this.paymentIntent)||void 0===m?void 0:m.processor_data)||void 0===v?void 0:v.stripe)||void 0===y?void 0:y.client_secret)||!this.container)return void console.warn("do not have client secret or container");const b=getComputedStyle(document.body);this.elements=this.stripe.elements({clientSecret:null===(w=null===(g=null===(f=this.paymentIntent)||void 0===f?void 0:f.processor_data)||void 0===g?void 0:g.stripe)||void 0===w?void 0:w.client_secret,appearance:{variables:{colorPrimary:b.getPropertyValue("--sc-color-primary-500"),colorText:b.getPropertyValue("--sc-input-label-color"),borderRadius:b.getPropertyValue("--sc-input-border-radius-medium"),colorBackground:b.getPropertyValue("--sc-input-background-color"),fontSizeBase:b.getPropertyValue("--sc-input-font-size-medium")},rules:{".Input":{border:b.getPropertyValue("--sc-input-border")},".Input::placeholder":{color:b.getPropertyValue("--sc-input-placeholder-color")}}}}),this.elements.create("payment",{wallets:{applePay:"never",googlePay:"never"}}).mount(".sc-payment-element-container"),this.element=this.elements.getElement("payment"),this.element.on("ready",(()=>this.loaded=!0))}async createPaymentIntent(){try{this.loading=!0,this.error="",this.paymentIntent=await(0,s.a)({method:"POST",path:"surecart/v1/payment_intents",data:{processor_type:"stripe",live_mode:this.liveMode,customer_id:this.customerId,refresh_status:!0}})}catch(e){this.error=(null==e?void 0:e.message)||(0,i._)("Something went wrong","surecart")}finally{this.loading=!1}}async handleSubmit(e){var t;e.preventDefault(),this.loading=!0;try{const e=await this.stripe.confirmSetup({elements:this.elements,confirmParams:{return_url:(0,a.a)(this.successUrl,{payment_intent:null===(t=this.paymentIntent)||void 0===t?void 0:t.id})},redirect:"always"});if(null==e?void 0:e.error)throw this.error=e.error.message,e.error}catch(e){console.error(e),this.error=(null==e?void 0:e.message)||(0,i._)("Something went wrong","surecart"),this.loading=!1}}render(){return(0,n.h)("sc-form",{onScFormSubmit:e=>this.handleSubmit(e)},this.error&&(0,n.h)("sc-alert",{open:!!this.error,type:"danger"},(0,n.h)("span",{slot:"title"},(0,i._)("Error","surecart")),this.error),(0,n.h)("div",{class:"loader",hidden:this.loaded},(0,n.h)("div",{class:"loader__row"},(0,n.h)("div",{style:{width:"50%"}},(0,n.h)("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),(0,n.h)("sc-skeleton",null)),(0,n.h)("div",{style:{flex:"1"}},(0,n.h)("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),(0,n.h)("sc-skeleton",null)),(0,n.h)("div",{style:{flex:"1"}},(0,n.h)("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),(0,n.h)("sc-skeleton",null))),(0,n.h)("div",{class:"loader__details"},(0,n.h)("sc-skeleton",{style:{height:"1rem"}}),(0,n.h)("sc-skeleton",{style:{height:"1rem",width:"30%"}}))),(0,n.h)("div",{hidden:!this.loaded,class:"sc-payment-element-container",ref:e=>this.container=e}),(0,n.h)("sc-button",{type:"primary",submit:!0,full:!0,loading:this.loading},(0,i._)("Save Payment Method","surecart")))}static get watchers(){return{paymentIntent:["handlePaymentIntentCreate"]}}};l.style="sc-stripe-add-method{display:block}sc-stripe-add-method [hidden]{display:none}.loader{display:grid;height:128px;gap:2em}.loader__row{display:flex;align-items:flex-start;justify-content:space-between;gap:1em}.loader__details{display:grid;gap:0.5em}"}}]);