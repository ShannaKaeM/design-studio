"use strict";(globalThis.webpackChunksuremembers=globalThis.webpackChunksuremembers||[]).push([[1717],{1717:(s,t,e)=>{e.r(t),e.d(t,{sc_password_nag:()=>o});var a=e(4589),r=e(9964),i=e(3659);e(857);const o=class{constructor(s){(0,a.r)(this,s),this.open=!0,this.type="primary",this.successUrl=void 0,this.set=void 0,this.loading=void 0,this.error=void 0,this.success=void 0,this.enableValidation=!0}handleSetChange(){setTimeout((()=>{this.input&&this.input.triggerFocus()}),50)}async dismiss(){this.loading=!0,this.error="";try{await(0,r.a)({path:"wp/v2/users/me",method:"PATCH",data:{meta:{default_password_nag:!1}}}),this.open=!1}catch(s){this.error=(null==s?void 0:s.message)||(0,i._)("Something went wrong","surecart"),this.loading=!1}}validatePassword(s){return!!new RegExp("^(?=.*?[#?!@$%^&*-]).{6,}$").test(s)}async handleSubmit(s){this.loading=!0,this.error="";try{const{password:t}=await s.target.getFormJson();await(0,r.a)({path:"wp/v2/users/me",method:"PATCH",data:{password:t,meta:{default_password_nag:!1}}}),this.dismiss(),this.success=!0}catch(s){this.error=(null==s?void 0:s.message)||(0,i._)("Something went wrong","surecart"),this.loading=!1}}render(){return this.success?(0,a.h)("sc-alert",{type:"success",open:!0},(0,a.h)("span",{slot:"title"},(0,i._)("Success!","surecart")),(0,i._)("You have successfully set your password.","surecart")):(0,a.h)(a.H,{tabindex:0,"aria-label":(0,i._)("You have not yet set a password. Please set a password for your account.","surecart")},(0,a.h)("sc-alert",{type:this.type,open:this.open,exportparts:"base, icon, text, title, message, close-icon",style:{position:"relative"}},!!this.error&&this.error,this.set?(0,a.h)("sc-dashboard-module",{class:"customer-details"},(0,a.h)("span",{slot:"heading"},(0,i._)("Set A Password","surecart")," "),(0,a.h)("sc-button",{type:"text",size:"small",slot:"end",onClick:()=>this.set=!1},(0,a.h)("sc-icon",{name:"x",slot:"prefix"}),(0,i._)("Cancel","surecart")),(0,a.h)("sc-card",null,(0,a.h)("sc-form",{onScFormSubmit:s=>this.handleSubmit(s)},(0,a.h)("sc-password",{enableValidation:this.enableValidation,label:(0,i._)("New Password","surecart"),name:"password",confirmation:!0,ref:s=>this.input=s,required:!0}),(0,a.h)("div",null,(0,a.h)("sc-button",{type:"primary",full:!0,submit:!0,busy:this.loading},(0,i._)("Set Password","surecart")))))):(0,a.h)(a.F,null,(0,a.h)("slot",{name:"title",slot:"title"},(0,i._)("Reminder","surecart")),(0,a.h)("slot",null,(0,i._)("You have not yet set a password. Please set a password for your account.","surecart")),(0,a.h)("sc-flex",{"justify-content":"flex-start"},(0,a.h)("sc-button",{size:"small",type:"primary",onClick:()=>this.set=!0},(0,i._)("Set A Password","surecart")),(0,a.h)("sc-button",{size:"small",type:"text",onClick:()=>this.dismiss()},(0,i._)("Dismiss","surecart")))),this.loading&&(0,a.h)("sc-block-ui",{spinner:!0})))}static get watchers(){return{set:["handleSetChange"]}}};o.style=":host{display:block}"}}]);